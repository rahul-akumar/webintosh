---
title: Viewport bounds hardening, Dock restore, and menubar/context menu system
version: 0.1.2
date: 2025-08-17
description: Eliminated desktop scrollbars, viewport-capped resizing, improved focus handling, Dock-based restore, and a new dynamic menubar with app-aware templates, context menu, submenus, Alt accelerators, Shortcuts app, and E2E coverage.
---

This entry captures all changes made today.

Added
- Dynamic, app-aware Menubar
  - Menubar title reflects Desktop (Webintosh) or the focused app; sections come from menu templates.
  - System menu: [app/components/os/menus/systemMenu.ts](app/components/os/menus/systemMenu.ts)
  - App menus: [app/components/apps/Finder/finderMenu.ts](app/components/apps/Finder/finderMenu.ts), [app/components/apps/TextEdit/textEditMenu.ts](app/components/apps/TextEdit/textEditMenu.ts)
  - Menubar rendering: [app/components/os/MenuBar.vue](app/components/os/MenuBar.vue)
- Shared menu model and command registry
  - Menu types: [types/menu.ts](types/menu.ts)
  - Commands (Alt accelerators, app/system actions): [app/composables/menuCommands.ts](app/composables/menuCommands.ts)
- Menu dropdown and context menu
  - Dropdown with items, separators, submenus, keyboard navigation: [app/components/os/MenuDropdown.vue](app/components/os/MenuDropdown.vue)
  - Desktop context menu with right‑click, reusing the same menu model: [app/components/os/ContextMenu.vue](app/components/os/ContextMenu.vue), opened from [app/components/os/Desktop.vue](app/components/os/Desktop.vue)
- Shortcuts app
  - Simple system app that lists Alt‑based shortcuts: [app/components/apps/Shortcuts/ShortcutsApp.vue](app/components/apps/Shortcuts/ShortcutsApp.vue)
- Keyboard accelerators (Alt-based to avoid browser conflicts)
  - Alt+N (Open/New Window or New Document based on focus), Alt+W (Close), Alt+M (Minimize), Alt+Z (Zoom), Alt+` (Cycle), Alt+/ (Shortcuts)
  - Handled globally in [app/components/os/WindowManager.vue](app/components/os/WindowManager.vue) via the command registry.

Changed
- Menubar behavior
  - Converted from a static “File/Edit/View” placeholder to dynamic, focus-aware sections based on active app or desktop in [app/components/os/MenuBar.vue](app/components/os/MenuBar.vue).
  - Top‑level menubar supports opening a section by click, switching sections by hover while open, Esc to close, and Left/Right arrow traversal between sections (events bubbled from dropdown).
- Command behavior
  - Alt+N always opens a new window/document for the focused app (no reuse) per updated handlers in [app/composables/menuCommands.ts](app/composables/menuCommands.ts).

Fixed
- Submenu stability and alignment
  - Submenus now open to the side of the parent item; a hover “bridge” prevents flicker when moving the pointer into the submenu: [app/components/os/MenuDropdown.vue](app/components/os/MenuDropdown.vue).
  - Submenu rows visually align with other items by reserving the same checkmark slot; submenu arrow is vertically centered.
- Suppressed accidental “active” row on open
  - Dropdown no longer highlights the first row immediately if the menu opens under the pointer; a short “just opened” suppression window prevents spurious hover activation: [app/components/os/MenuDropdown.vue](app/components/os/MenuDropdown.vue).

Removed
- Legacy Apple‑only menu state and shim
  - Deprecated isAppleOpen flag removed from [types/os.ts](types/os.ts).
  - Back‑compat shim toggleAppleMenu removed; all code now uses openMenubar/openContext/closeMenu in [stores/os.ts](stores/os.ts).

Notes
- E2E tests added and scoped “good enough” to Chromium locally; they serve as guardrails and can be extended later:
  - Menubar flows: [tests/e2e/menubar.spec.ts](tests/e2e/menubar.spec.ts)
  - Context menu: [tests/e2e/context-menu.spec.ts](tests/e2e/context-menu.spec.ts)
  - Accelerators: [tests/e2e/accelerators.spec.ts](tests/e2e/accelerators.spec.ts)
  - Run: pnpm test:e2e --project=chromium
- Prior viewport bounds and Dock refinements remain (see original description above); window content continues to scroll internally while the desktop does not.